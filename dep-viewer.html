<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dependency Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: #4ec9b0;
            margin-bottom: 20px;
            font-size: 2rem;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #252526;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #3e3e42;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4ec9b0;
        }
        
        .stat-label {
            color: #858585;
            margin-top: 5px;
        }
        
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        input, select {
            background: #252526;
            border: 1px solid #3e3e42;
            color: #d4d4d4;
            padding: 10px 15px;
            border-radius: 4px;
            font-size: 14px;
            flex: 1;
            min-width: 200px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4ec9b0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: #252526;
            border-radius: 8px;
            overflow: hidden;
        }
        
        th {
            background: #2d2d30;
            color: #4ec9b0;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
        }
        
        th:hover {
            background: #3e3e42;
        }
        
        td {
            padding: 12px 15px;
            border-top: 1px solid #3e3e42;
        }
        
        tr:hover {
            background: #2d2d30;
        }
        
        .file-name {
            color: #dcdcaa;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
        }
        
        .dep-count {
            color: #4ec9b0;
            font-weight: bold;
            font-size: 16px;
        }
        
        .dep-list {
            color: #858585;
            font-size: 12px;
            font-family: 'Consolas', 'Monaco', monospace;
            max-height: 100px;
            overflow-y: auto;
            line-height: 1.6;
        }
        
        .dep-item {
            display: block;
            padding: 2px 0;
        }
        
        .highlight-red {
            color: #f48771;
        }
        
        .highlight-yellow {
            color: #dcdcaa;
        }
        
        .highlight-green {
            color: #4ec9b0;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .badge-danger {
            background: #f48771;
            color: #1e1e1e;
        }
        
        .badge-warning {
            background: #dcdcaa;
            color: #1e1e1e;
        }
        
        .badge-success {
            background: #4ec9b0;
            color: #1e1e1e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Dependency Analyzer</h1>
        
        <div class="stats" id="stats"></div>
        
        <div class="controls">
            <input type="text" id="search" placeholder="üîç Search files...">
            <select id="filter">
                <option value="all">All Files</option>
                <option value="high">High Dependencies (10+)</option>
                <option value="medium">Medium Dependencies (5-9)</option>
                <option value="low">Low Dependencies (1-4)</option>
                <option value="none">No Dependencies</option>
            </select>
            <select id="sort">
                <option value="deps-desc">Most Dependencies First</option>
                <option value="deps-asc">Least Dependencies First</option>
                <option value="name-asc">Name (A-Z)</option>
                <option value="name-desc">Name (Z-A)</option>
            </select>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th onclick="sortTable('name')">File</th>
                    <th onclick="sortTable('deps')" style="width: 150px;">Dependencies</th>
                    <th>Depends On</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
    
    <script>
        let allData = [];
        let filteredData = [];
        
        // Load the JSON file
        async function loadData() {
            try {
                const response = await fetch('full-deps.json');
                const data = await response.json();
                
                // Convert to array format
                allData = Object.entries(data).map(([file, deps]) => ({
                    file: file,
                    deps: deps || [],
                    depCount: (deps || []).length
                }));
                
                displayStats();
                filteredData = [...allData];
                renderTable();
            } catch (error) {
                document.getElementById('tableBody').innerHTML = `
                    <tr><td colspan="3" style="text-align: center; padding: 40px; color: #f48771;">
                        ‚ö†Ô∏è Error loading full-deps.json. Make sure the file is in the same directory as this HTML file.
                        <br><br>Error: ${error.message}
                    </td></tr>
                `;
            }
        }
        
        function displayStats() {
            const totalFiles = allData.length;
            const totalDeps = allData.reduce((sum, item) => sum + item.depCount, 0);
            const avgDeps = (totalDeps / totalFiles).toFixed(1);
            const maxDeps = Math.max(...allData.map(item => item.depCount));
            const noDeps = allData.filter(item => item.depCount === 0).length;
            
            document.getElementById('stats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalFiles}</div>
                    <div class="stat-label">Total Files</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${totalDeps}</div>
                    <div class="stat-label">Total Dependencies</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${avgDeps}</div>
                    <div class="stat-label">Avg Deps/File</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${maxDeps}</div>
                    <div class="stat-label">Max Dependencies</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${noDeps}</div>
                    <div class="stat-label">Files with No Deps</div>
                </div>
            `;
        }
        
        function getDepBadge(count) {
            if (count >= 10) return '<span class="badge badge-danger">HIGH</span>';
            if (count >= 5) return '<span class="badge badge-warning">MEDIUM</span>';
            if (count > 0) return '<span class="badge badge-success">LOW</span>';
            return '<span class="badge" style="background: #3e3e42; color: #858585;">NONE</span>';
        }
        
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = filteredData.map(item => `
                <tr>
                    <td class="file-name">${item.file}</td>
                    <td>
                        <span class="dep-count">${item.depCount}</span>
                        ${getDepBadge(item.depCount)}
                    </td>
                    <td class="dep-list">
                        ${item.deps.length > 0 
                            ? item.deps.map(dep => `<span class="dep-item">${dep}</span>`).join('')
                            : '<span style="color: #858585;">No dependencies</span>'
                        }
                    </td>
                </tr>
            `).join('');
        }
        
        function applyFilters() {
            const searchTerm = document.getElementById('search').value.toLowerCase();
            const filterValue = document.getElementById('filter').value;
            const sortValue = document.getElementById('sort').value;
            
            // Filter
            filteredData = allData.filter(item => {
                const matchesSearch = item.file.toLowerCase().includes(searchTerm);
                let matchesFilter = true;
                
                switch(filterValue) {
                    case 'high':
                        matchesFilter = item.depCount >= 10;
                        break;
                    case 'medium':
                        matchesFilter = item.depCount >= 5 && item.depCount < 10;
                        break;
                    case 'low':
                        matchesFilter = item.depCount >= 1 && item.depCount < 5;
                        break;
                    case 'none':
                        matchesFilter = item.depCount === 0;
                        break;
                }
                
                return matchesSearch && matchesFilter;
            });
            
            // Sort
            switch(sortValue) {
                case 'deps-desc':
                    filteredData.sort((a, b) => b.depCount - a.depCount);
                    break;
                case 'deps-asc':
                    filteredData.sort((a, b) => a.depCount - b.depCount);
                    break;
                case 'name-asc':
                    filteredData.sort((a, b) => a.file.localeCompare(b.file));
                    break;
                case 'name-desc':
                    filteredData.sort((a, b) => b.file.localeCompare(a.file));
                    break;
            }
            
            renderTable();
        }
        
        // Event listeners
        document.getElementById('search').addEventListener('input', applyFilters);
        document.getElementById('filter').addEventListener('change', applyFilters);
        document.getElementById('sort').addEventListener('change', applyFilters);
        
        // Load data on page load
        loadData();
    </script>
</body>
</html>

